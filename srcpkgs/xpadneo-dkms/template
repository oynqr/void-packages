# Template file for 'xpadneo-dkms'
pkgname=xpadneo-dkms
version=0.9
revision=1
wrksrc=xpadneo-${version}
depends="dkms bluez"
short_desc="Advanced Linux Driver for Xbox One Wireless Gamepad"
maintainer="Cameron Katri <katri.cameron@gmail.com>"
license="GPL-2.0-or-later"
homepage="https://github.com/atar-axis/xpadneo"
distfiles="https://github.com/atar-axis/xpadneo/archive/v${version}.tar.gz"
checksum=54ce4cddae2f1bba0571fb8a30194bf94cac65ba18fae71ccd7a592952493b41
dkms_modules="hid-xpadneo ${version}"

pre_configure() {
	vsed -i 's/PACKAGE_VERSION="@DO_NOT_CHANGE@"/PACKAGE_VERSION="'"${version}"'"/g' hid-xpadneo/dkms.conf
	vsed -i 's/#define DRV_VER "@DO_NOT_CHANGE@"/#define DRV_VER "'"${version}"'"/g' hid-xpadneo/src/hid-xpadneo.c
	vsed -i 's@/etc/udev/rules.d@/usr/lib/udev/rules.d@g' hid-xpadneo/dkms.post_install hid-xpadneo/dkms.post_remove
}

do_install() {
	vmkdir usr/src/hid-xpadneo-${version}
	vcopy "hid-xpadneo/*" usr/src/hid-xpadneo-${version}
}
