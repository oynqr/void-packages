# Template file for 'Shortwave'
pkgname=Shortwave
version=2.0.1
revision=1
_commit=a6841faf7745758bea7f4f04adf2aa6df8b390f9
wrksrc=${pkgname}-${_commit}
build_style=meson
build_helper=rust
hostmakedepends="cargo gettext git glib-devel pkg-config sqlite-devel"
makedepends="gstreamer1-devel gst-plugins-bad1-devel gtk4-devel libadwaita-devel
 openssl-devel rust-std sqlite-devel"
depends="gst-plugins-good1"
checkdepends="desktop-file-utils"
short_desc="GTK internet radio player, written in Rust"
maintainer="Philipp David <pd@3b.pm>"
license="GPL-3.0-or-later"
homepage="https://gitlab.gnome.org/World/Shortwave"
distfiles="https://gitlab.gnome.org/World/${pkgname}/-/archive/${_commit}/${pkgname}-${_commit}.tar.gz"
checksum=02479eb4c4e317d0c0c9ff91e1294a4bad30e51110fd978238285db03b1dd190

post_patch() {
	if [ "$CROSS_BUILD" ]; then
		vsed -i build-aux/cargo.sh \
			-e 's%"$CARGO_TARGET_DIR"/%&${RUST_TARGET}/%' \
			-e '/CARGO_HOME/d'
	fi
}
